{"version":3,"file":"extended.cjs","sources":["../../src/src/extended.js"],"sourcesContent":["/*!\n * Copyright (c) 2017-present Cliqz GmbH. All rights reserved.\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { tokenize, RECURSIVE_PSEUDO_CLASSES } from './parse';\nexport const EXTENDED_PSEUDO_CLASSES = new Set([\n    // '-abp-contains',\n    // '-abp-has',\n    // '-abp-properties',\n    'has',\n    'has-text',\n    'if',\n    // 'if-not',\n    // 'matches-css',\n    // 'matches-css-after',\n    // 'matches-css-before',\n    // 'min-text-length',\n    // 'nth-ancestor',\n    // 'upward',\n    // 'watch-attr',\n    // 'watch-attrs',\n    // 'xpath',\n]);\nexport const PSEUDO_CLASSES = new Set([\n    'active',\n    'any',\n    'any-link',\n    'blank',\n    'checked',\n    'default',\n    'defined',\n    'dir',\n    'disabled',\n    'empty',\n    'enabled',\n    'first',\n    'first-child',\n    'first-of-type',\n    'focus',\n    'focus-visible',\n    'focus-within',\n    'fullscreen',\n    'host',\n    'host-context',\n    'hover',\n    'in-range',\n    'indeterminate',\n    'invalid',\n    'is',\n    'lang',\n    'last-child',\n    'last-of-type',\n    'left',\n    'link',\n    'matches',\n    // NOTE: by default we consider `:not(...)` to be a normal CSS selector since,\n    // we are only interested in cases where the argument is an extended selector.\n    // If that is the case, it will still be detected as such.\n    'not',\n    'nth-child',\n    'nth-last-child',\n    'nth-last-of-type',\n    'nth-of-type',\n    'only-child',\n    'only-of-type',\n    'optional',\n    'out-of-range',\n    'placeholder-shown',\n    'read-only',\n    'read-write',\n    'required',\n    'right',\n    'root',\n    'scope',\n    'target',\n    'valid',\n    'visited',\n    'where',\n]);\n// NOTE: here we only need to list the pseudo-elements which can appear with a\n// single colon (e.g. :after or ::after are valid for backward compatibility\n// reasons). They can be misinterpreted as pseudo-classes by the tokenizer for\n// this reason.\nexport const PSEUDO_ELEMENTS = new Set(['after', 'before', 'first-letter', 'first-line']);\nexport var SelectorType;\n(function (SelectorType) {\n    SelectorType[SelectorType[\"Normal\"] = 0] = \"Normal\";\n    SelectorType[SelectorType[\"Extended\"] = 1] = \"Extended\";\n    SelectorType[SelectorType[\"Invalid\"] = 2] = \"Invalid\";\n})(SelectorType || (SelectorType = {}));\nexport function classifySelector(selector) {\n    // In most cases there is no pseudo-anything so we can quickly exit.\n    if (selector.indexOf(':') === -1) {\n        return SelectorType.Normal;\n    }\n    const tokens = tokenize(selector);\n    // Detect pseudo-classes\n    let foundSupportedExtendedSelector = false;\n    for (const token of tokens) {\n        if (token.type === 'pseudo-class') {\n            const { name } = token;\n            if (EXTENDED_PSEUDO_CLASSES.has(name) === true) {\n                foundSupportedExtendedSelector = true;\n            }\n            else if (PSEUDO_CLASSES.has(name) === false && PSEUDO_ELEMENTS.has(name) === false) {\n                return SelectorType.Invalid;\n            }\n            // Recursively\n            if (foundSupportedExtendedSelector === false &&\n                token.argument !== undefined &&\n                RECURSIVE_PSEUDO_CLASSES.has(name) === true) {\n                const argumentType = classifySelector(token.argument);\n                if (argumentType === SelectorType.Invalid) {\n                    return argumentType;\n                }\n                else if (argumentType === SelectorType.Extended) {\n                    foundSupportedExtendedSelector = true;\n                }\n            }\n        }\n    }\n    if (foundSupportedExtendedSelector === true) {\n        return SelectorType.Extended;\n    }\n    return SelectorType.Normal;\n}\n//# sourceMappingURL=extended.js.map"],"names":["SelectorType","tokenize","RECURSIVE_PSEUDO_CLASSES"],"mappings":"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"}