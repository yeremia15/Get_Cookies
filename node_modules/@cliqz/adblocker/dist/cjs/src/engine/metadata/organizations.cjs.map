{"version":3,"file":"organizations.cjs","sources":["../../../../src/src/engine/metadata/organizations.js"],"sourcesContent":["/*!\n * Copyright (c) 2017-present Cliqz GmbH. All rights reserved.\n *\n * This Source Code Form is subject to the terms of the Mozilla Public\n * License, v. 2.0. If a copy of the MPL was not distributed with this\n * file, You can obtain one at https://mozilla.org/MPL/2.0/.\n */\nimport { CompactMap } from '../map';\nimport { sizeOfUTF8 } from '../../data-view';\nimport { fastHash } from '../../utils';\n/**\n * This function takes an object representing an organization from TrackerDB\n * dump and validates its shape. The result is the same object, but strongly\n * typed.\n */\nexport function isValid(organization) {\n    if (organization === null) {\n        return false;\n    }\n    if (typeof organization !== 'object') {\n        return false;\n    }\n    const { key, name, description, country, website_url: websiteUrl, privacy_policy_url: privacyPolicyUrl, privacy_contact: privacyContact, ghostery_id: ghosteryId, } = organization;\n    if (typeof key !== 'string') {\n        return false;\n    }\n    if (typeof name !== 'string') {\n        return false;\n    }\n    if (description !== null && typeof description !== 'string') {\n        return false;\n    }\n    if (country !== null && typeof country !== 'string') {\n        return false;\n    }\n    if (websiteUrl !== null && typeof websiteUrl !== 'string') {\n        return false;\n    }\n    if (privacyPolicyUrl !== null && typeof privacyPolicyUrl !== 'string') {\n        return false;\n    }\n    if (privacyContact !== null && typeof privacyContact !== 'string') {\n        return false;\n    }\n    if (ghosteryId !== null && typeof ghosteryId !== 'string') {\n        return false;\n    }\n    return true;\n}\nexport function getKey(organization) {\n    return fastHash(organization.key);\n}\nexport function getSerializedSize(organization) {\n    return (sizeOfUTF8(organization.key) +\n        sizeOfUTF8(organization.name) +\n        sizeOfUTF8(organization.description || '') +\n        sizeOfUTF8(organization.website_url || '') +\n        sizeOfUTF8(organization.country || '') +\n        sizeOfUTF8(organization.privacy_policy_url || '') +\n        sizeOfUTF8(organization.privacy_contact || '') +\n        sizeOfUTF8(organization.ghostery_id || ''));\n}\nexport function serialize(organization, view) {\n    view.pushUTF8(organization.key);\n    view.pushUTF8(organization.name);\n    view.pushUTF8(organization.description || '');\n    view.pushUTF8(organization.website_url || '');\n    view.pushUTF8(organization.country || '');\n    view.pushUTF8(organization.privacy_policy_url || '');\n    view.pushUTF8(organization.privacy_contact || '');\n    view.pushUTF8(organization.ghostery_id || '');\n}\nexport function deserialize(view) {\n    return {\n        key: view.getUTF8(),\n        name: view.getUTF8(),\n        description: view.getUTF8() || null,\n        website_url: view.getUTF8() || null,\n        country: view.getUTF8() || null,\n        privacy_policy_url: view.getUTF8() || null,\n        privacy_contact: view.getUTF8() || null,\n        ghostery_id: view.getUTF8() || null,\n    };\n}\nexport function createMap(organizations) {\n    return new CompactMap({\n        getSerializedSize,\n        getKeys: (organization) => [getKey(organization)],\n        serialize,\n        deserialize,\n        values: organizations,\n    });\n}\n//# sourceMappingURL=organizations.js.map"],"names":["fastHash","sizeOfUTF8","CompactMap"],"mappings":"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"}